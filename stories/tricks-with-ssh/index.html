<!DOCTYPE html> <html> <head> <title>Tricks with SSH - botleg</title> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="description" content="Almost all developers have some sort of experience working with Secure Shell or SSH. It allows you to connect to a remote location and communicate securely. ..."> <meta name="author" content="Hanzel Jesheen"> <meta name="twitter:card" content="Couple of SSH techniques that saved me a lot of time and helped me with tricky situations." /> <meta name="twitter:site" content="@HanzelJesheen" /> <meta name="twitter:creator" content="@HanzelJesheen" /> <meta property="og:url" content="https://botleg.com/stories/tricks-with-ssh/" /> <meta property="og:type" content="article" /> <meta property="og:title" content="Tricks with SSH" /> <meta property="og:description" content="Couple of SSH techniques that saved me a lot of time and helped me with tricky situations." /> <meta property="og:image" content="" /> <meta property="og:site_name" content="botleg" /> <meta property="article:author" content="Hanzel Jesheen" /> <meta itemprop="name" content="Tricks with SSH"> <meta itemprop="description" content="Almost all developers have some sort of experience working with Secure Shell or SSH. It allows you to connect to a remote location and communicate securely. ..."> <link rel="canonical" href="https://botleg.com/stories/tricks-with-ssh/"> <link rel="alternate" type="application/rss+xml" title="botleg" href="https://botleg.com/feed" /> </head> <body> <div class="page-content"> <div class="post"> <header style="background:#3CA55C;background:-webkit-linear-gradient(to left, #3CA55C , #B5AC49);background:linear-gradient(to left, #3CA55C , #B5AC49);"> <section class="site-header"> <div class="wrapper"> <a class="site-title" href="/">Botleg</a> <div id="search"> <a href="/feed/index.xml"><span class="rss-icon"> <svg viewBox="0 0 24 24" width="30px" height="30px"> <use xlink:href="/assets/images/sprites.svg#rss"></use> </svg></span> </a> <form id="searchform"> <input type="text" placeholder="search" id="searchbox"> </form> </div> </div> </section> <section class="post-header"> <div class="header-content"> <h1 class="post-title">Tricks with SSH</h1> </div> </section> </header> <div class="wrapper"> <section> <article class="post-content"> <p class="post-meta">Written by Hanzel Jesheen on Dec 1, 2015 | <a href="/categories/misc">misc</a> </p> <p>Almost all developers have some sort of experience working with <code class="highlighter-rouge">Secure Shell</code> or <code class="highlighter-rouge">SSH</code>. It allows you to connect to a remote location and communicate securely. In this article, I’ll share couple of tips that will make working with SSH easier.</p> <h2 id="ssh-config">SSH Config</h2> <p>The basic way of connecting to a remote server is,</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">ssh user@ip -p 22</code></pre></figure> <p>It is not easy to remember a bunch of ip addresses and type those in everytime you want to connect to a remote server. SSH allows you to give alias to each connection configuration including hostname, username, port, etc. This is done with <code class="highlighter-rouge">SSH Config</code>.</p> <p>Add a new file, <code class="highlighter-rouge">~/.ssh/config</code>. For each connection, add this block to the config file we just created.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">  Host &lt;<span class="nb">alias</span>&gt;
    HostName &lt;host-address&gt;
    Port &lt;port&gt;
    User &lt;username&gt;
    IdentityFile &lt;private-key-file&gt;</code></pre></figure> <p>The <code class="highlighter-rouge">IdentityFile</code> field is optional, and it contains the path of the private key used for identity. An example of this block is given below.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">  Host myremote
    HostName 101.102.103.104
    Port 22
    User root
    IdentityFile ~/.ssh/myremote.key</code></pre></figure> <p>We can log into this remote server with the command,</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">ssh myremote</code></pre></figure> <p>If you have copied your key to remote as an authorized key with <code class="highlighter-rouge">ssh-copy-id</code>, you will be connected to the remote server. Even tab completion works for the alias names. Pretty convenient, right?</p> <h2 id="local-port-forward">Local Port Forward</h2> <p>SSH can be used to forward ports from a remote server to local system and vice-versa. Now, we’ll talk only about the former, also called local port forwarding. It is generally used to access blocked websites in a network. You can forward any of your local ports to a blocked site, and access it with the assigned local port.</p> <p>For instance, you can forward your local port 5000 to <a href="http://youtube.com">YouTube</a> with,</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">ssh -L 5000:youtube.com:80 user@host</code></pre></figure> <p>Now, you can access YouTube at <a href="http://localhost:5000">localhost:5000</a>.</p> <p>There are a couple of other use cases for local port forwarding. The main one is to access services for local development. Most database in the network will only allow access to localhost and remote access will be blocked by the firewall. While it’s good for security, it would make the database inaccessible for local development.</p> <p>We can use local port forwarding to solve this issue. Let’s assume, I’ve a <a href="http://redis.io/">Redis</a> database running in <code class="highlighter-rouge">120.10.20.30:16379</code>. If I have SSH access to this remote server, I can forward the remote port <code class="highlighter-rouge">16379</code> to any of my local port.</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">ssh -L 0.0.0.0:5866:120.10.20.30:16379 user@host -Nf</code></pre></figure> <p>We will go through all the different things in this command. The <code class="highlighter-rouge">-L</code> flag for the SSH command tells that it’s a local port forward command.</p> <p>The basic format of local port forward is,</p> <figure class="highlight"><pre><code class="language-bash" data-lang="bash">&lt;<span class="nb">local</span>-ip&gt;:&lt;<span class="nb">local</span>-port&gt;:&lt;remote-ip&gt;:&lt;remote-port&gt;</code></pre></figure> <p>Here, the local ip is <code class="highlighter-rouge">0.0.0.0</code>. What it does is that, it listens to all hosts in the network. So, any host in your network can access the Redis database with your ip. The local port is <code class="highlighter-rouge">5866</code>. If your local ip address is <code class="highlighter-rouge">10.18.0.13</code>, then Redis database can be accessed by anybody in your network at <code class="highlighter-rouge">10.18.0.13:5866</code> and for you, it’s <code class="highlighter-rouge">localhost:5866</code>. If your avoid the <code class="highlighter-rouge">local-ip</code> part, only you can access the database.</p> <p>The <code class="highlighter-rouge">remote-port</code> and <code class="highlighter-rouge">remote-ip</code> is that of the service, we need to forward. In the case, we are forwarding the database in <code class="highlighter-rouge">120.10.20.30:16379</code>. Now we need to provide the user and host of the remote SSH login. As discussed above, we can replace this with an alias in SSH config.</p> <p>There are two more flags in the command and these are very important. <code class="highlighter-rouge">-N</code> flag asks the SSH to NOT execute the remote command. This prevents the remote shell from coming up. ‘-f’ flag makes the SSH to go into the background and excute the command like a daemon. Together, we can the flag <code class="highlighter-rouge">-Nf</code>.</p> <h2 id="conclusion">Conclusion</h2> <p>In this article, I’ve shared two SSH techniques that saved me a lot of time and helped me with tricky situations. The first one involves using a config file for SSH and other one involves local port forwarding.</p> <p class="post-meta">Tags: SSH, secure, shell, config, remote, local, port, ip, alias, forward, and misc </p> </article> <article class="post-comments" id="comments-box"> <h1 class="page-title">Comments</h1> <form id="new-comment"> <input type="text" id="nameField" placeholder="Enter your name" required><br/> <textarea id="textField" placeholder="Your comments please." required></textarea><br/> <button type="submit" id="commentBtn">Post Comment</button> </form> <div id="comments"></div> </article> </section> <aside class="post-aside"> <div class ="aside" id="cat-list"> <h1 class="page-heading">Categories</h1> <a href="/categories/misc">Misc</a><br/> <a href="/categories/jekyll">Jekyll</a><br/> <a href="/categories/cloud">Cloud</a><br/> <a href="/categories/Node.js">Node.js</a><br/> <a href="/categories/javascript">Javascript</a><br/> <a href="/categories/devops">Devops</a><br/> <a href="/categories/crypto">Crypto</a><br/> </div> <div class ="aside"> <h1 class="page-heading">Related Stories</h1> <a href=/stories/share-your-localhost/>Share your localhost</a><br/><a href=/stories/auto-scaling-with-docker/>Auto Scaling with Docker</a><br/><a href=/stories/https-with-lets-encrypt-and-nginx/>HTTPS with Let's Encrypt and nginx</a><br/><a href=/stories/using-your-sessions-with-socketio/>Using your sessions with Socket.IO</a><br/><a href=/stories/line-numbers-in-jekyll-code-blocks/>Line numbers in Jekyll code blocks</a><br/> </div> <p class="rss-subscribe">subscribe <a href="/feed">via RSS</a></p> <a href="#">Scroll to Top</a> </aside> </div> </div> </div> <footer class="site-footer"> <div class="footer-wrap"> <h2 class="footer-heading"><a href="/">botleg</a></h2> <div class="footer-col-wrapper"> <div class="footer-col footer-col-1"> <ul class="contact-list"> <li>By Hanzel Jesheen</li> <li><a href="mailto:blog@botleg.com">blog@botleg.com</a></li> </ul> </div> <div class="footer-col footer-col-2"> <ul class="social-media-list"> <li> <a href="https://github.com/botleg"> <span class="footer-icon"> <svg viewBox="0 0 16 16" width="16px" height="16px"> <use xlink:href="/assets/images/sprites.svg#gh"></use> </svg> </span> <span class="username">github</span> </a> </li> <li class="username"> <span class="footer-icon"> <svg viewBox="0 0 24 24" width="16px" height="16px"> <use xlink:href="/assets/images/sprites.svg#rss"></use> </svg> </span> subscribe <a href="/feed">via RSS</a> </li> </ul> </div> <div class="footer-col footer-col-3"> <p>Hi, botleg is a blog where you can find tutorials and techniques in web development, devops, databases, cloud computing and anything related to technology.</p> </div> </div> </div> </footer> <style type="text/css">body,h1,h2{font-weight:300}.wrapper:after{clear:both}html{box-sizing:border-box}body{background-color:#fdfdfd;color:#111;font-family:Helvetica,Arial,sans-serif;font-size:18px;line-height:1.6;}.wrapper section{margin-top:30px}a{color:#2a7ae2;text-decoration:none}.site-header{min-height:60px;position:relative}.site-title{margin-bottom:0;float:left;font-size:28px;line-height:60px;text-transform:lowercase;color:#e8e8e8}.post-header{box-align:center;justify-content:center;color:#fdfdfd;display:flex;height:300px;margin-bottom:10px}.rss-icon,#searchbox{display:none;}.post-header .header-content{text-align:center;max-width:600px}.icon{background-position:10px center;background-repeat:no-repeat;background-size:30px;padding:0 30px 0 45px}.icon span{color:#fdfdfd;display:none}@media screen and (min-width:400px){.icon span{display:inline}}.post-title{color:#e8e8e8;font-size:36px}.page-content,.post-content{margin-bottom:20px}.page-content h2,.post-content h2{font-size:32px}</style> <script> var cb = function() { var l = document.createElement('link'); l.rel = 'stylesheet'; l.href = '/assets/main.css?v310'; var h = document.getElementsByTagName('head')[0]; h.parentNode.insertBefore(l, h); }; var raf = requestAnimationFrame || mozRequestAnimationFrame || webkitRequestAnimationFrame || msRequestAnimationFrame; if (raf) raf(cb); else window.addEventListener('load', cb); </script> <script async type="text/javascript" src="/assets/js/post.js"></script> </body> </html>
