var searchbox=document.getElementById("searchform"),comments=document.getElementById("comments"),newComment=document.getElementById("new-comment"),nameField=document.getElementById("nameField"),textField=document.getElementById("textField"),commentBtn=document.getElementById("commentBtn"),length=0,xhr=new XMLHttpRequest;
function search(a){a.preventDefault();""!==document.getElementById("searchbox").value.trim()&&(window.location.href="/search/#"+document.getElementById("searchbox").value.trim().split(" ").join("+"))}function render(a){if(length=a.length){comments.innerHTML="";for(var b=0;b<a.length;b++)comments.innerHTML+='<p class="comment-block"><span class="text">'+a[b].name+"</span><br/>"+a[b].text+"</p>"}else comments.innerHTML='<p class="comment-block text">No comments yet.</p>'}
function add(){length++?comments.innerHTML='<p class="comment-block"><span class="text">'+nameField.value+"</span><br/>"+textField.value+"</p>"+comments.innerHTML:comments.innerHTML='<p class="comment-block"><span class="text">'+nameField.value+"</span><br/>"+textField.value+"</p>";nameField.value="";textField.value="";commentBtn.disabled=!1;commentBtn.innerHTML="Post Comment"}
function addComment(a){a.preventDefault();""!==nameField.value.trim()&&""!==textField.value.trim()&&(commentBtn.disabled=!0,commentBtn.innerHTML="Posting...",xhr.open("POST",encodeURI("https://api.botleg.com/comment/"+window.location.pathname.split("/")[2])),xhr.setRequestHeader("Content-Type","application/json"),xhr.onload=function(){200===xhr.status&&xhr.responseText&&add()},xhr.send(JSON.stringify({name:nameField.value,text:textField.value})))}comments.innerHTML='<span class="text">Loading comments...</span>';
xhr.open("GET",encodeURI("https://api.botleg.com/comment/"+window.location.pathname.split("/")[2]));xhr.onload=function(){200===xhr.status&&render(JSON.parse(xhr.responseText))};xhr.send();searchbox.addEventListener?(searchbox.addEventListener("submit",search,!1),newComment.addEventListener("submit",addComment,!1)):searchbox.attachEvent&&(searchbox.attachEvent("onsubmit",search),newComment.attachEvent("onsubmit",addComment));