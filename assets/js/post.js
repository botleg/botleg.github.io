function search(e){e.preventDefault(),""!==document.getElementById("searchbox").value.trim()&&(window.location.href="/search/#"+document.getElementById("searchbox").value.trim().split(" ").join("+"))}function render(e){if(length=e.length,!length)return void(comments.innerHTML='<p class="comment-block text">No comments yet.</p>');comments.innerHTML="";for(var t=0;t<e.length;t++)comments.innerHTML+='<p class="comment-block"><span class="text">'+e[t].name+"</span><br/>"+e[t].text+"</p>"}function add(){comments.innerHTML=length++?'<p class="comment-block"><span class="text">'+nameField.value+"</span><br/>"+textField.value+"</p>"+comments.innerHTML:'<p class="comment-block"><span class="text">'+nameField.value+"</span><br/>"+textField.value+"</p>",nameField.value="",textField.value="",commentBtn.disabled=!1,commentBtn.innerHTML="Post Comment"}function addComment(e){e.preventDefault(),""!==nameField.value.trim()&&""!==textField.value.trim()&&(commentBtn.disabled=!0,commentBtn.innerHTML="Posting...",xhr.open("POST",encodeURI("http://api.botleg.com/comment/"+window.location.pathname.split("/")[2])),xhr.setRequestHeader("Content-Type","application/json"),xhr.onload=function(){200===xhr.status&&xhr.responseText&&add()},xhr.send(JSON.stringify({name:nameField.value,text:textField.value})))}var searchbox=document.getElementById("searchform"),comments=document.getElementById("comments"),newComment=document.getElementById("new-comment"),nameField=document.getElementById("nameField"),textField=document.getElementById("textField"),commentBtn=document.getElementById("commentBtn"),length=0,xhr=new XMLHttpRequest;comments.innerHTML='<span class="text">Loading comments...</span>',xhr.open("GET",encodeURI("http://api.botleg.com/comment/"+window.location.pathname.split("/")[2])),xhr.onload=function(){200===xhr.status&&render(JSON.parse(xhr.responseText))},xhr.send(),searchbox.addEventListener?(searchbox.addEventListener("submit",search,!1),newComment.addEventListener("submit",addComment,!1)):searchbox.attachEvent&&(searchbox.attachEvent("onsubmit",search),newComment.attachEvent("onsubmit",addComment));